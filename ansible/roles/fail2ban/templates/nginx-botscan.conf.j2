# Fail2ban filter for nginx bot scanning / vulnerability probing
# Managed by Ansible - do not edit manually

[Definition]

# Matches common vulnerability scanning patterns:
# - PHP file probing (*.php, *.php7, etc.)
# - WordPress admin paths
# - Common shell/backdoor filenames
# - Empty user agents with suspicious paths

failregex = ^<HOST> .* "(GET|POST|HEAD) .*\.(php|php7|phtml|asp|aspx|jsp|cgi)\b.*" (400|403|404|405|500|502|503) .*$
            ^<HOST> .* "(GET|POST|HEAD) .*/wp-(admin|content|includes|login).*" (400|403|404|405|500|502|503) .*$
            ^<HOST> .* "(GET|POST|HEAD) .*/(admin|manager|administrator|phpmyadmin|pma|mysql|shell|config).*" (400|403|404|405|500|502|503) .*$
            ^<HOST> .* "(GET|POST|HEAD) .*\.(env|git|svn|bak|old|backup|sql|db|conf|ini|log).*" (400|403|404|405|500|502|503) .*$
            ^<HOST> .* "(GET|POST|HEAD) .*/\.(well-known|git|svn|env).*\.(php|txt|bak).*" (400|403|404|405|500|502|503) .*$

ignoreregex = 

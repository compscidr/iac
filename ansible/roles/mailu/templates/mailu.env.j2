# Mailu configuration file (consolidated with nginx-proxy)
# Generated by Ansible

# Common configuration
SECRET_KEY={{ mailu_secret_key }}
DOMAIN={{ mailu_domain }}
HOSTNAMES={{ mailu_hostname }}
POSTMASTER=admin

# Network configuration
SUBNET={{ mailu_subnet }}
REAL_IP_HEADER=X-Forwarded-For
REAL_IP_FROM={{ mailu_nginx_proxy_subnet | default('172.18.0.0/16') }}

# TLS configuration
# Using certs from shared letsencrypt volume (managed by nginx-proxy companion)
TLS_FLAVOR=cert

# Authentication settings
AUTH_RATELIMIT_IP=60/hour
AUTH_RATELIMIT_USER=100/day
DISABLE_STATISTICS=True

# Message rate limiting
MESSAGE_RATELIMIT={{ mailu_message_ratelimit }}
{% if mailu_message_ratelimit_exemption %}
MESSAGE_RATELIMIT_EXEMPTION={{ mailu_message_ratelimit_exemption }}
{% endif %}

# Website settings (accessed via nginx-proxy)
WEB_ADMIN=/admin
WEB_WEBMAIL=/webmail
WEBMAIL={{ mailu_webmail }}

# Compose paths
COMPOSE_PROJECT_NAME=mailu

# Logging
LOG_LEVEL=INFO

# Advanced settings
RECIPIENT_DELIMITER=+
DMARC_RUA=admin@{{ mailu_domain }}
DMARC_RUF=admin@{{ mailu_domain }}
WELCOME=false
WELCOME_SUBJECT=Welcome to {{ mailu_domain }}
WELCOME_BODY=Welcome to your new email account

# Antivirus
{% if mailu_antivirus %}
ANTIVIRUS=clamav
{% else %}
ANTIVIRUS=none
{% endif %}

# WebDAV
{% if mailu_webdav %}
WEBDAV=radicale
{% else %}
WEBDAV=none
{% endif %}

# Fetchmail
{% if mailu_fetchmail %}
FETCHMAIL_ENABLED=true
{% else %}
FETCHMAIL_ENABLED=false
{% endif %}

# Admin interface
ADMIN=true
API=false
